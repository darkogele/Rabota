@inherits System.Web.Mvc.WebViewPage

<div class="col-lg-5 col-lg-offset-3">
    <form name="userr.form">
        <h2 class="text-center">Промена на кориснички податоци</h2>
        <hr />
        <div class="form-group" ng-class="{ 'has-error' : usernameFormField.username.$invalid }">
            <label class="clearfix">Корисничко име</label>
            <ng-form name="usernameFormField">
                <input type="text" class="form-control" name="username" data-ng-model="user.userName" required autofocus />
            </ng-form>
        </div>
        <div class="form-group" ng-class="{ 'has-error' : emailFormField.email.$invalid }">
            <label class="clearfix">Е-mail</label>
            <ng-form name="emailFormField">
                <input type="email" class="form-control" name="email" data-ng-model="user.email" required autofocus />
            </ng-form>
        </div>
        <div ng-if="authentication.isAuth && !getUserPermission('SuperAdmin')" class="form-group has-feedback" ng-class="{ 'has-error' : oldPasswordFormField.password.$invalid }" style="position: relative">
            <label class="clearfix">Лозинка</label>
            <ng-form name="oldPasswordFormField">
                <input type="password" class="form-control" name="oldpassword" password-show-hide element-number="1" data-ng-model="user.oldpassword" ng-pattern="passwordPattern"/>
                <p class="error" style="padding-top: 2px" ng-show="oldPasswordFormField.oldpassword.$error.pattern">Лозинката мора да има минумум една голема, една мала буква, еден број, еден специјален карактер и да е со минимална должина од 6 карактери</p>
            </ng-form>
        </div>
        <div class="form-group has-feedback" ng-class="{ 'has-error' : passwordFormField.password.$invalid }" style="position: relative">
            <label class="clearfix">Нова лозинка <i class="fa fa-info-circle" tooltip-placement="right" tooltip="Лозинката мора да има минумум една голема, една мала буква, еден број, еден специјален карактер и да е со минимална должина од 6 карактери" aria-hidden="true"></i></label>
            <ng-form name="passwordFormField">
                <input type="password" class="form-control" name="password" password-show-hide element-number="2" data-ng-model="user.password" ng-pattern="passwordPattern" />
                <p class="error" style="padding-top: 2px" ng-show="passwordFormField.password.$error.pattern">Лозинката мора да има минумум една голема, една мала буква, еден број, еден специјален карактер и да е со минимална должина од 6 карактери</p>
            </ng-form>
        </div>
        <div class="form-group has-feedback" ng-class="{ 'has-error' : confirmPasswordFormField.ConfirmPassword.$invalid }" style="position: relative">
            <label class="clearfix">Потврди нова лозинка</label>
            <ng-form name="confirmPasswordFormField">
                <input type="password" class="form-control" name="ConfirmPassword" password-show-hide element-number="3" data-ng-model="user.confirmPassword" />
            </ng-form>
        </div>
        <div ng-if="authentication.isAuth && (getUserPermission('SuperAdmin') || getUserPermission('Admin'))" class="form-group">
            <label class="clearfix">Улога</label>
            <select class="form-control"
                    ng-model="user.userRole"
                    name="roleforuser"
                    ng-required="true"
                    ng-class="{ 'has-error' : userr.form.roleforuser.$invalid }">
                <option value="" disabled>Одбери улога</option>
                <option ng-selected="{{role.isSelected}}" ng-repeat="role in user.userRoles" value="{{role.id}}" ng-show="role.isAvailableForSelecting">{{role.name}}</option>
            </select>
        </div>
        <div ng-if="authentication.isAuth && (getUserPermission('SuperAdmin') || getUserPermission('Admin'))" class="form-group">
            <label class="clearfix">Достапни сервиси:</label>
            <div />
            <div ng-repeat="servicerole in user.serviceRoles">
                <input type="checkbox"
                       name="selectedServiceRoles[]"
                       value="{{servicerole.id}}"
                       ng-checked="{{!servicerole.isAvailableForSelecting}}"
                       ng-click="toggleSelection(servicerole.id)"> {{servicerole.name}}
            </div>
        </div>
        <div class="modal-footer">
            <button ng-click="save(user)" type="submit" class="btn btn-primary" ng-disabled="userr.form.$invalid"><i class="fa fa-save" /> Зачувај</button>
            <button ng-click="discardChange()" ng-if="authentication.isAuth && (getUserPermission('SuperAdmin') || getUserPermission('Admin'))" type="submit" class="btn btn-warning">Откажи</button>
            <button ng-if="authentication.isAuth && getUserPermission('User')" type="submit" class="btn btn-warning" ui-sref="home">Откажи</button>
        </div>
    </form>
</div>